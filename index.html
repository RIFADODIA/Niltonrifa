<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RIFA BRASIL - MRC</title>
<script>
const config = {
  premiumValue: "1 800 REAIS",   // Primeiro prêmio
  secondPrize: "2 100 REAIS",                    // Segundo prêmio (ex: "100 Reais"), vazio = não aparece
  thirdPrize: "3 100 REAIS",                     // Terceiro prêmio
  ticketValue: 20,
  winningNumber: "",  // Agora pode ser números separados por espaço como você quer
  reservedGroups: "[1] [2] [.3dazinha] [4] [5] [6] [7] [8] [9] [.10neide] [11] [12] [.13dodo] [14] [.15evericio] [16] [.17marcelo] [18] [19] [20] [21] [.22cassio] [23] [.24vadique] [.25dazinha] [26] [.27rodrigo s q] [28] [.29Maria] [.30moacir] [.31nene] [.32neilza] [33] [.34vadique] [.35gael] [36] [37] [.38claudia] [.39nego] [40] [.41evericio] [42] [43] [44] [45] [.46evericio] [47] [.48dora] [.49joao d g] [50] [51] [.52joao d g] [53] [.54rodrigo s q] [55] [.56conceiçao] [.57marcelo] [58] [59] [60] [61] [62] [63] [64] [65] [66] [67] [68] [69] [.70gu] [71] [72] [73] [.74dora] [75] [76] [77] [78] [79] [80] [81] [82] [83] [84] [85] [86] [87] [88] [.89dora] [90] [91] [92] [93] [.94edmilson] [95] [96] [97] [.98edmilson] [.99evericio] [00]",
  pixKey: "75981816830 NILTON CESAR GABRIEL MACHADO",
  whatsappNumber: "5575981816830",
  prizeImages: [
    "https://i.ibb.co/nMD6c8bc/Screenshot-2025-09-08-14-32-02-234-com-android-chrome.png",
    "https://i.ibb.co/2YmztL9K/Screenshot-2025-08-31-23-01-52-623-com-whatsapp-w4b.png",
    "https://i.ibb.co/FLJxP1r2/IMG-20250812-WA0018.jpg"
  ]
};
let selectedGroup = null;
let generatedId = null;
</script>
<style>
* {margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
html, body {width:100%; height:100%; overflow-x:hidden; background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460); color:white;}
body {overflow-y:auto; display: flex; flex-direction: column;}
.container {width:100%; max-width:500px; margin:0 auto; padding:15px; position:relative; flex: 1;}
.container::before {content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#ff6b6b,#ff9e6b);}
.header{text-align:center;margin-bottom:15px;padding-bottom:12px;border-bottom:1px solid rgba(255,255,255,0.1);}
h1{color:#ff6b6b;margin-bottom:6px;font-size:22px;text-transform:uppercase;letter-spacing:1px;font-weight:700;}
.header p{color:#ff9e6b;font-weight:500;font-size:13px;}
.prize-carousel-section {margin-bottom:15px;}
.prize-carousel {width:100%; border-radius:10px; overflow:hidden; box-shadow:0 5px 15px rgba(0,0,0,0.3);}
.prize-carousel-container {display:flex; overflow-x:auto; scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch;}
.prize-slide {flex:0 0 auto; width:100%; scroll-snap-align:start;}
.prize-img {width:100%; border-radius:8px; display:block;}
.carousel-nav {display:flex; justify-content:center; margin-top:10px; gap:8px;}
.carousel-dot {width:8px; height:8px; border-radius:50%; background: rgba(255,255,255,0.3); cursor:pointer;}
.carousel-dot.active {background:#ff6b6b;}
.welcome-message{background:rgba(30,30,46,0.8);padding:12px;border-radius:10px;margin-bottom:15px;font-size:14px;line-height:1.4;border-left:4px solid #ff6b6b;text-align:center;}
.welcome-message p{margin:0;color:#cdd6f4;}
.button-container {display:flex;gap:8px;justify-content:center;margin-top:10px;flex-wrap:wrap;}
.last-winner-btn {padding:8px 16px;background:linear-gradient(90deg, #ff6b6b, #ff9e6b);color:#fff;font-weight:600;border:none;border-radius:20px;cursor:pointer;transition:all 0.3s;font-size:13px;}
.last-winner-btn:hover {transform:translateY(-2px);}
.prize-info{background:rgba(30,30,46,0.8);padding:12px;border-radius:10px;margin-bottom:15px;text-align:center;border:1px dashed #ff6b6b;}
.prize-info h2{color:#ff6b6b;margin-bottom:6px;font-size:18px;font-weight:700;}
.prize-info p{color:#ff6b6b;font-weight:600;font-size:14px;}
.blocks-container{display:grid;grid-template-columns:repeat(5,1fr);gap:6px;margin-bottom:15px;}
.block{background:rgba(30,30,46,0.8);border:1px solid #ff6b6b;border-radius:8px;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:8px 3px;min-height:60px;cursor:pointer;}
.block-number {font-size:16px;font-weight:bold;margin-bottom:2px;color:#ff6b6b;}
.block-status {font-size:10px;font-weight:bold;margin-top:2px;text-transform:uppercase;}
.block.reserved{background:rgba(74,10,10,0.8);color:#fff;border-color:#ff4081;cursor:not-allowed;}
.block.reserved .block-status {color: #ff9e9e;}
.block.available .block-status {color: #a5d6a7;}
.block.winner{background:rgba(76,175,80,0.8);color:#fff;border-color:#66bb6a;box-shadow: 0 0 10px rgba(76,175,80,0.5);}
.winner-section{background:rgba(30,30,46,0.8);padding:12px;border-radius:10px;margin-top:15px;text-align:center;border-left:4px solid #ff6b6b;}
.winner-section h3{color:#ff6b6b;margin-bottom:8px;font-size:16px;}
.no-winner{font-style:italic;color:#ff9e6b;}
.footer-note{text-align:center;margin-top:15px;color:#ff9e6b;font-size:12px;padding:15px;}
.modal {display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.8);z-index:1000;justify-content:center;align-items:center;flex-direction:column;}
.modal-content {background:rgba(30,30,46,0.95);padding:20px;border-radius:12px;border:2px solid #ff6b6b;text-align:center;max-width:90%;max-height:90%;display:flex;flex-direction:column;align-items:center;}
.modal-content img {max-width:100%;max-height:70vh;border-radius:8px;}
.modal-content h2 {color:#ff6b6b;margin-bottom:15px;}
.close-modal {margin-top:15px;padding:8px 20px;background:#ff6b6b;color:white;border:none;border-radius:20px;cursor:pointer;font-weight:bold;}
.confirmation-section {display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(30,30,46,0.95);padding:20px;border-radius:12px;border:2px solid #ff6b6b;z-index:1000;text-align:center; max-width:90%; width:350px;}
.confirmation-message {margin-bottom:20px; font-weight:bold; color:#cdd6f4; font-size:16px; line-height:1.5; text-align:left;}
.confirmation-buttons {display:flex;justify-content:center;gap:15px;}
.btn {padding:12px 20px;border:none;border-radius:8px;font-weight:bold;cursor:pointer;transition:all 0.3s;font-size:16px;min-width:90px;}
.btn-yes {background:linear-gradient(90deg,#4caf50,#66bb6a);color:#fff;box-shadow:0 0 15px rgba(76,175,80,0.4);}
.btn-yes:hover {transform:scale(1.05);box-shadow:0 0 25px rgba(76,175,80,0.5);}
.btn-no {background:linear-gradient(90deg,#c62828,#e53935);color:white;box-shadow:0 0 15px rgba(198,40,40,0.4);}
.btn-no:hover {transform:scale(1.05);box-shadow:0 0 25px rgba(198,40,40,0.5);}
.overlay {display: none; position: fixed; top:0; left:0; width:100%; height:100%; background-color: rgba(0,0,0,0.7); z-index:999;}
.reserved-name {font-size:9px;color:#ffcccc;text-align:center;max-width:90%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;}
</style>
</head>
<body>
<div class="overlay" id="overlay"></div>
<div class="container">
  <div class="header">
    <h1>RIFA DE NILTON CESAR</h1>
    <p>SORTEIO PELA FEDERAL 19h - ASSIM QUE ENCHER</p>
  </div>
  <div class="prize-carousel-section">
    <div class="prize-carousel">
      <div class="prize-carousel-container" id="prizeCarousel"></div>
      <div class="carousel-nav" id="carouselNav"></div>
    </div>
  </div>
  <div class="welcome-message">
    <p><strong>Seja bem-vindo!</strong> Clique no número que deseja e escolha SIM ou NÃO para reservar.</p>
    <div class="button-container">
      <button class="last-winner-btn" id="showWinnerBtn">Clique para ver ganhador</button>
    </div>
  </div>
  <div class="prize-info">
    <h2>Prêmios:</h2>
    <p id="prize1"></p>
    <p id="prize2"></p>
    <p id="prize3"></p>
    <p>Valor por cota: R$ <span id="ticketValue"></span>,00</p>
  </div>
  <div class="blocks-container" id="blocksContainer"></div>
  <div class="winner-section">
    <h3>Número Sorteado</h3>
    <p><strong id="winnerNumber" class="no-winner">Aguardando sorteio...</strong></p>
  </div>
</div>

<div class="confirmation-section" id="confirmationSection">
  <div class="confirmation-message" id="confirmationMessage"></div>
  <div class="confirmation-buttons">
    <button class="btn btn-yes" id="btnYes">Sim</button>
    <button class="btn btn-no" id="btnNo">Não</button>
  </div>
</div>

<div class="modal" id="winnerModal">
  <div class="modal-content">
    <h2>Último Ganhador</h2>
    <img class="modal-img" src="https://i.ibb.co/2xzJH6f/Picsart-25-08-24-14-33-04-951.jpg" alt="Último ganhador da rifa">
    <button class="close-modal" id="closeModal">Fechar</button>
  </div>
</div>

<div class="footer-note">RIFA MRC © 2025 - Todos os direitos reservados</div>

<script>
function init() {
  document.getElementById("ticketValue").textContent = config.ticketValue;

  // Configurar prêmios dinâmicos
  const prizeFields = ["prize1", "prize2", "prize3"];
  const prizes = [config.premiumValue, config.secondPrize, config.thirdPrize];
  prizeFields.forEach((fieldId, index) => {
    const el = document.getElementById(fieldId);
    if (prizes[index] && prizes[index].trim() !== "") {
      el.textContent = prizes[index];
      el.style.display = "block";
    } else {
      el.style.display = "none";
    }
  });

  generateBlocks();
  updateWinnerDisplay();
  setupPrizeCarousel();

  document.getElementById("btnYes").addEventListener("click", confirmSelection);
  document.getElementById("btnNo").addEventListener("click", cancelSelection);
  document.getElementById("showWinnerBtn").addEventListener("click", showWinner);
  document.getElementById("closeModal").addEventListener("click", closeWinnerModal);
  document.getElementById("overlay").addEventListener("click", () => {
    document.getElementById("confirmationSection").style.display = "none";
    document.getElementById("winnerModal").style.display = "none";
    document.getElementById("overlay").style.display = "none";
  });
  initCarousel();
}

function parseReservedGroups(reservedString) {
  const reservedData = [];
  const regex = /\[\.?([^\]]+)\]/g;
  let match;
  while ((match = regex.exec(reservedString)) !== null) {
    const content = match[1].trim();
    const isReserved = match[0].startsWith('[.'); // ponto indica reservado com nome
    let numberMatch = content.match(/^\d+/);
    if (!numberMatch) continue;
    let number = parseInt(numberMatch[0]);
    if (number === 0) number = 100;
    if (number < 1 || number > 100) continue;
    const name = isReserved ? content.replace(/^\d+/, '').trim() || "Reservado" : null;
    reservedData.push({ number, name, isReserved });
  }
  return reservedData;
}

// Função para processar múltiplos números sorteados (agora com espaços)
function parseWinningNumbers(winningNumber) {
  if (!winningNumber && winningNumber !== 0) return [];
  
  // Se for uma string, separar por espaço e converter para números
  if (typeof winningNumber === 'string') {
    return winningNumber.split(/\s+/)
      .map(num => {
        const parsed = parseInt(num.trim());
        return parsed === 0 ? 100 : parsed;
      })
      .filter(num => !isNaN(num) && num >= 1 && num <= 100);
  }
  
  // Se for um único número, retornar como array
  return [winningNumber];
}

function generateBlocks() {
  const container = document.getElementById("blocksContainer");
  container.innerHTML = "";
  const reservedData = parseReservedGroups(config.reservedGroups);
  const winningNumbers = parseWinningNumbers(config.winningNumber);

  for (let i = 1; i <= 100; i++) {
    const block = document.createElement("div");
    block.className = "block";
    block.dataset.block = i;
    
    const reservedInfo = reservedData.find(item => item.number === i);
    const isReserved = reservedInfo && reservedInfo.isReserved;
    const isWinner = winningNumbers.includes(i);
    
    const statusText = isWinner ? "GANHADOR" : (isReserved ? "ESCOLHIDO" : "DISPONÍVEL");
    const nameElement = isReserved && reservedInfo.name ? `<div class="reserved-name">${reservedInfo.name}</div>` : '';
    const displayNumber = i === 100 ? "00" : i;
    
    block.innerHTML = `<div class="block-number">${displayNumber}</div><div class="block-status">${statusText}</div>${nameElement}`;

    if (isReserved) {
      block.classList.add("reserved");
    } else {
      block.classList.add("available");
      block.addEventListener("click", () => {
        selectedGroup = i;
        generatedId = generateRandomId();
        showConfirmation(i, generatedId);
      });
    }

    if (isWinner) {
      block.classList.add("winner");
      block.classList.remove("reserved");
      block.classList.remove("available");
    }

    container.appendChild(block);
  }
}

function showConfirmation(number, id) {
  const displayNumber = number === 100 ? "00" : number;
  const msg = `Deseja enviar esse número para o WhatsApp; junto o ID para Nilton; para marcar seu número aqui no site?\n\nNúmero: ${displayNumber}\nID: ${id}`;
  document.getElementById("confirmationMessage").textContent = msg;
  document.getElementById("overlay").style.display = "block";
  document.getElementById("confirmationSection").style.display = "block";
}

function confirmSelection() {
  if (selectedGroup && generatedId) {
    const idText = `NUMERO-${selectedGroup}-${generatedId}`;
    navigator.clipboard.writeText(idText);
    const message = encodeURIComponent(`OLÁ, GOSTARIA DE RESERVAR O NÚMERO ${selectedGroup}\nMEU ID DE CONFIRMAÇÃO É: ${idText}\n\nCHAVE PIX PARA PAGAMENTO:\n${config.pixKey}\n\nAGUARDANDO O COMPROVANTE 🙏 ACOMPANHE SITE AQUI: https://rifadodia.github.io/Niltonrifa/`);
    window.open(`https://wa.me/${config.whatsappNumber}?text=${message}`, '_blank');
    document.getElementById("confirmationSection").style.display = "none";
    document.getElementById("overlay").style.display = "none";
    selectedGroup = null;
    generatedId = null;
  }
}

function cancelSelection() {
  document.getElementById("confirmationSection").style.display = "none";
  document.getElementById("overlay").style.display = "none";
  selectedGroup = null;
  generatedId = null;
}

function updateWinnerDisplay() {
  const winnerElement = document.getElementById("winnerNumber");
  const winningNumbers = parseWinningNumbers(config.winningNumber);
  
  if (winningNumbers.length === 0) {
    winnerElement.textContent = "Aguardando sorteio...";
    winnerElement.className = "no-winner";
    return;
  }
  
  // Formatar números para exibição (00 em vez de 100)
  const displayNumbers = winningNumbers.map(num => num === 100 ? "00" : num);
  winnerElement.textContent = `${displayNumbers.join(", ")}`;
  winnerElement.className = "";
}

function generateRandomId(length = 6) {
  const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
  let result = "";
  for (let i = 0; i < length; i++) result += chars.charAt(Math.floor(Math.random() * chars.length));
  return result;
}

function showWinner() {
  document.getElementById('winnerModal').style.display = 'flex';
  document.getElementById("overlay").style.display = "block";
}

function closeWinnerModal() {
  document.getElementById('winnerModal').style.display = 'none';
  document.getElementById("overlay").style.display = "none";
}

function setupPrizeCarousel() {
  const carousel = document.getElementById('prizeCarousel');
  const nav = document.getElementById('carouselNav');
  carousel.innerHTML = '';
  nav.innerHTML = '';
  config.prizeImages.forEach((imgSrc, index) => {
    const slide = document.createElement('div');
    slide.className = 'prize-slide';
    slide.innerHTML = `<img class="prize-img" src="${imgSrc}" alt="Prêmio ${index + 1}">`;
    carousel.appendChild(slide);

    const dot = document.createElement('div');
    dot.className = 'carousel-dot' + (index === 0 ? ' active' : '');
    dot.dataset.index = index;
    dot.addEventListener('click', () => {
      carousel.scrollTo({ left: carousel.clientWidth * index, behavior: 'smooth' });
    });
    nav.appendChild(dot);
  });
}

function initCarousel() {
  const carousel = document.getElementById('prizeCarousel');
  carousel.addEventListener('scroll', () => {
    const scrollPos = carousel.scrollLeft;
    const slideWidth = carousel.clientWidth;
    const activeIndex = Math.round(scrollPos / slideWidth);
    document.querySelectorAll('.carousel-dot').forEach((dot, index) => {
      dot.classList.toggle('active', index === activeIndex);
    });
  });
}

document.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
